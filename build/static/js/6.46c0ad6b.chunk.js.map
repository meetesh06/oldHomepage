{"version":3,"sources":["pages/PostPage.js"],"names":["useStyles","makeStyles","theme","actionBar","marginLeft","spacing","paper","marginRight","marginBottom","padding","minHeight","fontFamily","textDecoration","breakpoints","down","marginTop","heading","fontSize","typography","pxToRem","fontWeight","fontWeightBold","divider","categoryName","dateHolder","display","alignItems","dateStyle","fontWeightLight","markdownHolder","markdownImage","maxWidth","loader","alignSelf","LoadingHeader","postMetaData","classes","className","variant","component","title","label","category","created","HomeContent","props","posts","useSelector","getPostsJson","idRaw","useParams","dispatch","useDispatch","secretPass","selectSecret","useState","loadingPost","setLoadingPost","setPostMetaData","postData","setPostData","found","setFound","navigate","useNavigate","useEffect","post","JSONPath","path","id","json","secret","length","smoothLoadingEnd","updateCurrentPost","meta","axios","get","nonCachedRequest","URI_POST_FILES","link","then","response","data","Crypto","AES","decrypt","toString","enc","Utf8","lines","split","splice","newtext","join","catch","err","finally","renderPostFromLink","color","msg","renderers","math","value","block","inlineMath","code","language","wrapLongLines","wrapLines","style","coldarkDark","children","image","pageVariants","in","opacity","y","out","FadeIn","FadeOut","pageTransitions","duration","type","div","initial","animate","exit","variants","transition","aria-label","arrow","onClick","size","motion","elevation","plugins","gutterBottom","borderRadius","width","height"],"mappings":"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","file":"static/js/6.46c0ad6b.chunk.js","sourcesContent":["\nimport React from 'react';\nimport { makeStyles } from '@mui/styles';\nimport Paper from '@mui/material/Paper';\nimport Typography from '@mui/material/Typography';\nimport {JSONPath} from 'jsonpath-plus';\nimport ReactMarkdown from 'react-markdown';\nimport Tex from '@matejmazur/react-katex'\nimport math from 'remark-math'\nimport 'katex/dist/katex.min.css'\nimport Divider from '@mui/material/Divider';\n\nimport {\n  useNavigate,\n  useParams\n} from \"react-router-dom\";\n\nimport axios from 'axios';\nimport { Skeleton } from '@mui/material';\nimport {Prism as SyntaxHighlighter} from 'react-syntax-highlighter'\nimport { xonokai, coldarkDark } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport Chip from '@mui/material/Chip';\n\nimport Tooltip from '@mui/material/Tooltip';\n\nimport LinearProgress from '@mui/material/LinearProgress';\nimport IconButton from '@mui/material/IconButton';\n\nimport {\n  Link\n} from \"react-router-dom\";\n\nimport {\n  AnimatePresence,\n  motion\n} from 'framer-motion';\nimport { URI_POST_FILES } from '../config';\nimport { nonCachedRequest } from '../components/helper';\n\nimport { useSelector, useDispatch } from 'react-redux';\nimport { updateCurrentPost } from '../features/currentPostSlice';\nimport { getPostsJson } from '../features/allPostsSlice';\n\nimport { selectSecret } from '../features/secretState';\n\n\nimport Crypto from \"crypto-js\";\nimport RightSidebar from '../components/RightSidebar';\nimport { Close, Undo } from '@material-ui/icons';\nimport { useEffect } from 'react';\nimport { useState } from 'react';\n\nconst useStyles = makeStyles((theme) => ({\n  actionBar: {\n    // position: 'static',\n    // left: 0,\n    // right: 0\n    marginLeft: theme.spacing(2),\n    // marginTop: theme.spacing(1),\n  },\n  paper: {\n    marginLeft: theme.spacing(10),\n    marginRight: theme.spacing(10),\n    marginBottom: theme.spacing(2),\n    padding: theme.spacing(6),\n    minHeight: '50vh',\n    fontFamily: 'Roboto',\n    \"& a\": {\n      textDecoration: \"none\",\n    },\n    [theme.breakpoints.down('lg')]: {\n      marginLeft: theme.spacing(2),\n      marginRight: theme.spacing(2),\n      marginTop: theme.spacing(1),\n      padding: theme.spacing(2),\n    },\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(40),\n    fontWeight: theme.typography.fontWeightBold\n  },\n  divider: {\n    marginTop: theme.spacing(4),\n  },\n  categoryName: {\n    marginRight: theme.spacing(1),\n  },\n  dateHolder: {\n    display: \"flex\",\n    alignItems: \"center\",\n    marginTop: theme.spacing(2)\n  },\n  dateStyle: {\n    fontWeight: theme.typography.fontWeightLight,\n    fontSize: theme.typography.pxToRem(13)\n  },\n  markdownHolder: {\n    // padding: theme.spacing(2)\n  },\n  markdownImage: {\n    maxWidth: '100%'\n  },\n  loader: {\n    alignSelf: 'center'\n  }\n}));\n\n\nconst LoadingHeader = (postMetaData) => {\n  const classes = useStyles();\n\n  return(\n    <div>\n      <Typography className={classes.heading} variant=\"h2\" component=\"h1\">\n        {postMetaData.title}\n      </Typography>\n      <span className={classes.dateHolder}>\n        <Chip className={classes.categoryName} label={postMetaData.category} />\n        <Typography className={classes.dateStyle} variant=\"body2\" component=\"p\">\n          created on {postMetaData.created}\n        </Typography>\n      </span>\n      <Divider className={classes.divider} variant=\"middle\" />\n    </div>\n  );\n\n}\n\nfunction HomeContent(props) {\n  // Hooks\n  const posts = useSelector(getPostsJson);\n  const classes = useStyles();\n  const { idRaw } = useParams();\n  const dispatch = useDispatch();\n  const secretPass = useSelector(selectSecret);\n  const [loadingPost, setLoadingPost] = useState(true);\n  const [postMetaData, setPostMetaData] = useState(null);\n  const [postData, setPostData] = useState(\"\");\n  const [found, setFound] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const renderPostFromLink = (meta) => {\n      axios.get(nonCachedRequest(URI_POST_FILES+'/'+meta.link, {}))\n        .then((response) => {\n          let post = response.data\n          \n          if (meta.category === \"Secret\") {\n            var bytes  = Crypto.AES.decrypt(post, secretPass);\n            // If the encoding fails, we know for sure it was a wrong password, hence the catch case will set the not found flag to true\n            post = bytes.toString(Crypto.enc.Utf8);\n          }\n\n          var lines = post.split('\\n');\n          // get rid of the metadata comments\n          lines.splice(0,5);\n          var newtext = lines.join('\\n');\n\n          setPostData(newtext);\n        })\n        .catch((err) => {\n          setFound(false);\n        })\n        .finally(() => {\n          smoothLoadingEnd();\n        })\n    }\n\n    let post = JSONPath({path: `$.posts[?(@.id === ${id})]`, json: posts})\n    let secret = false;\n    if(post.length < 1) {\n      secret = true;\n      if (!secretPass) {\n        smoothLoadingEnd();\n        setFound(false);\n        return;\n      }\n      post = JSONPath({path: `$.secrets[?(@.id === ${id})]`, json: posts})\n    }\n\n    if(post.length < 1) {\n      smoothLoadingEnd();\n      setFound(false);\n    } else {\n      if (!secret) {\n        dispatch(updateCurrentPost(post[0]));\n      }\n      let meta = post[0]\n      setPostMetaData(meta);      \n      renderPostFromLink(meta);\n      setFound(true);\n    }\n  }, [idRaw]);\n\n  if (!posts) {\n    return <LinearProgress color=\"secondary\" />\n  }\n\n  const id = idRaw.split('-')[0];\n  const smoothLoadingEnd = () => {\n    setLoadingPost(false);\n  }\n\n\n  const renderSkeleton = (msg) => (\n    <div>\n      <Typography gutterBottom variant=\"h6\" component=\"h2\">\n        {msg}\n      </Typography>\n      <Skeleton style={{borderRadius: 5}} variant=\"rectangular\" width={\"100%\"} height={\"60vh\"} />\n    </div>\n  )\n\n  function ImageRenderer(props) {\n    return <img {...props} className={classes.markdownImage} />\n  }\n  \n\n  const renderers = {\n    math: ({value}) => <Tex block math={value} />,\n    inlineMath: ({value}) => <Tex math={value} />,\n    code: ({language, value}) => {\n      return <SyntaxHighlighter wrapLongLines wrapLines style={coldarkDark} language={language} children={value} />\n    },\n    image: ImageRenderer\n  }\n\n  const pageVariants = {\n    in: {\n      opacity: 1,\n      y: 0\n    },\n    out: {\n      opacity: 0,\n      y: \"10vh\"\n    },\n    FadeIn: {\n      opacity: 1\n    },\n    FadeOut: {\n      opacity: 0\n    }\n  }\n\n  const pageTransitions = {\n    duration: .2,\n    type: \"backInOut\",\n  }\n\n  \n  return loadingPost ? <LinearProgress variant=\"indeterminate\" /> :\n  <motion.div\n    key=\"idRaw\"\n    initial=\"out\"\n    animate=\"in\"\n    exit=\"out\"\n    variants={pageVariants}\n    transition={pageTransitions}\n  >\n    \n      <div className={classes.actionBar}>\n        <Tooltip title=\"Close\" aria-label=\"close\" arrow>\n          {/* <Link to=\"/\"> */}\n            <IconButton onClick={() => {\n              navigate('/blog')\n            }} color=\"primary\" aria-label=\"close\" size=\"large\">\n              <Close />\n            </IconButton>\n          {/* </Link> */}\n        </Tooltip>\n      </div>\n      <Paper\n        component={motion.div}\n        initial=\"FadeOut\"\n        animate=\"FadeIn\"\n        exit=\"FadeOut\"\n        variants={pageVariants}\n        transition={pageTransitions}\n        className={classes.paper} elevation={3}>\n        {\n          !found ? (renderSkeleton(\"Post not found, please drop an email so I can have a look at this 👻 Thank you\")) : \n            loadingPost ? <LoadingHeader postMetaData={postMetaData} /> :\n          \n            <div>\n              <Typography\n                className={classes.heading}\n                variant=\"h2\"\n                component=\"h1\">\n                {postMetaData.title}\n              </Typography>\n              <span className={classes.dateHolder}>\n                <Chip className={classes.categoryName} label={postMetaData.category} />\n                <Typography className={classes.dateStyle} variant=\"body2\" component=\"p\">\n                  created on {postMetaData.created}\n                </Typography>\n              </span>\n              <Divider className={classes.divider} variant=\"middle\" />\n              <ReactMarkdown className={classes.markdownHolder} plugins={[math]} renderers={renderers}>\n                {postData}\n              </ReactMarkdown>\n            </div>\n        }\n      </Paper>\n  </motion.div>;\n}\n\nexport default HomeContent;\n"],"sourceRoot":""}